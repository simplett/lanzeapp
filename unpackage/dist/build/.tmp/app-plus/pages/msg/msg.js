(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/msg/msg"],{3234:function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement;e._self._c},i=[];s.d(t,"a",function(){return a}),s.d(t,"b",function(){return i})},"367d":function(e,t,s){"use strict";s.r(t);var a=s("baf3"),i=s.n(a);for(var u in a)"default"!==u&&function(e){s.d(t,e,function(){return a[e]})}(u);t["default"]=i.a},"6cf9":function(e,t,s){"use strict";(function(e){s("590e"),s("921b");a(s("66fd"));var t=a(s("9c08"));function a(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,s("6e42")["createPage"])},"7b35":function(e,t,s){"use strict";var a=s("a9d2"),i=s.n(a);i.a},"9c08":function(e,t,s){"use strict";s.r(t);var a=s("3234"),i=s("367d");for(var u in i)"default"!==u&&function(e){s.d(t,e,function(){return i[e]})}(u);s("7b35");var n=s("2877"),c=Object(n["a"])(i["default"],a["a"],a["b"],!1,null,null,null);t["default"]=c.exports},a9d2:function(e,t,s){},baf3:function(e,t,s){"use strict";(function(e,s){function a(e){return n(e)||u(e)||i()}function i(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function u(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function n(e){if(Array.isArray(e)){for(var t=0,s=new Array(e.length);t<e.length;t++)s[t]=e[t];return s}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c={data:function(){return{SUMMSG:{},chatList:[{uid:1,username:"鲜果蔬专营店",face:"/static/img/im/face/face_1.jpg",time:"13:08",msg:"亲，20点前下单都是当天送达的",tisNum:1},{uid:2,username:"官店大欺客旗舰店",face:"/static/img/im/face/face_2.jpg",time:"13:05",msg:"问那么多干什么？不想买就滚~",tisNum:0},{uid:3,username:"妙不可言",face:"/static/img/im/face/face_3.jpg",time:"12:15",msg:"推荐一个商品呗？",tisNum:0},{uid:4,username:"茶叶专卖",face:"/static/img/im/face/face_4.jpg",time:"12:11",msg:"现在卖的都是未过青的茶哦",tisNum:0},{uid:5,username:"likeKiss客服",face:"/static/img/im/face/face_5.jpg",time:"12:10",msg:"你好，发福建快递多久送到的？",tisNum:0},{uid:6,username:"白开水",face:"/static/img/im/face/face_6.jpg",time:"12:10",msg:"在吗？",tisNum:0},{uid:7,username:"衣帽间的叹息",face:"/static/img/im/face/face_7.jpg",time:"11:56",msg:"新品上市，欢迎选购",tisNum:0},{uid:8,username:"景萧疏",face:"/static/img/im/face/face_8.jpg",time:"11:56",msg:"商品七天无理由退换的",tisNum:0},{uid:9,username:"文宁先生",face:"/static/img/im/face/face_9.jpg",time:"12:15",msg:"星期天再发货的",tisNum:0},{uid:10,username:"高端Chieh",face:"/static/img/im/face/face_10.jpg",time:"12:36",msg:"建议你直接先测量好尺码在选购的。",tisNum:0},{uid:11,username:"mode旗舰店",face:"/static/img/im/face/face_11.jpg",time:"12:40",msg:"新品5折，还有大量优惠券。",tisNum:0},{uid:12,username:"敏萘客服",face:"/static/img/im/face/face_12.jpg",time:"12:36",msg:"还没有用，等我明天早上试一下",tisNum:0},{uid:13,username:"春天里的花",face:"/static/img/im/face/face_13.jpg",time:"12:36",msg:"适用于成年人的，小孩不适用的",tisNum:0},{uid:14,username:"电脑外设专业户",face:"/static/img/im/face/face_13.jpg",time:"12:36",msg:"把上面的螺丝拆下来，把铁片撬开就能看见了",tisNum:0},{uid:15,username:"至善汽车用品",face:"/static/img/im/face/face_15.jpg",time:"12:36",msg:"这个产品是原车配件，完美装上的",tisNum:10}]}},onPullDownRefresh:function(){setTimeout(function(){e.stopPullDownRefresh()},1e3)},onLoad:function(){this.changedata(),this.getmymsg()},methods:{endgetlist:function(t){var a=[];console.log(s(t," at pages\\msg\\msg.vue:167"));var i=0;for(var u in t)a[i]={},a[i]["uid"]=t[u][2],a[i]["time"]=t[u][0][t[u][0].length-1],a[i]["msg"]=t[u][1][t[u][0].length-1]["msg"],a[i]["tisNum"]=1,a[i]["pace"]="https://simplett-img.oss-cn-beijing.aliyuncs.com/user_image/userimage.jpg",a[i]["username"]="simplett",i++;this.chatList=a,console.log(s(a,"提取出聊天的列表"," at pages\\msg\\msg.vue:181"));var n=function(t){m=a[t].uid,e.request({url:"http://120.79.19.253:10086/Search",data:{uid:m,type:"user"},success:function(e){console.log(s(e.data," at pages\\msg\\msg.vue:192")),a[t]["username"]=e.data.nickname,a[t]["face"]=e.data.image}})};for(var c in a){var m;n(c)}this.chatList={},this.chatList=a,console.log(s(this.chatList,"??????"," at pages\\msg\\msg.vue:200"))},changedata:function(){var t=this;e.getStorage({key:"summsg",success:function(e){t.SUMMSG=e.data,console.log(s(e.data," at pages\\msg\\msg.vue:207")),e.data&&t.endgetlist(e.data)},fail:function(e){console.log(s("失败"," at pages\\msg\\msg.vue:215"))}})},getmymsg:function(){var t=this;setInterval(function(){console.log(s("请求聊天的数据"," at pages\\msg\\msg.vue:221"));var i="";e.getStorage({key:"token",success:function(e){i=e.data}}),i&&e.request({url:"http://120.79.19.253:10086/Chat",data:{token:i,type:"get"},success:function(i){console.log(s(i.data," at pages\\msg\\msg.vue:237"));var u=i.data.data,n={};if(u){console.log(s("收到的聊天消息",u," at pages\\msg\\msg.vue:241")),n=u.reduce(function(e,t){console.log(s(JSON.parse(t.message)," at pages\\msg\\msg.vue:244"));var a=JSON.parse(t.message);return void 0===e[a.suid]?(e[a.suid]=[[]],e[a.suid][0]=[],e[a.suid][1]=[],e[a.suid][2]="",e[a.suid][0].unshift(a.time),e[a.suid][1].unshift({user:"you",msg:a.message}),e[a.suid][2]=a.suid):(e[a.suid][0].unshift(a.time),e[a.suid][1].unshift({user:"you",msg:a.message})),e},{});var c={};for(var m in e.getStorage({key:"summsg",success:function(e){c=e.data}}),n)void 0==c[m]?(c[m]=[[]],console.log(s("@@@@@@@@@@@@@@@@@@@@@@@@@",n[m][0],n[m][1],n[m][2],m," at pages\\msg\\msg.vue:286")),c[m][0]=[],console.log(s("&&&&&&&&&&&&&&&&&&&&&",n[m][0]," at pages\\msg\\msg.vue:288")),c[m][1]=[],c[m][2]="",c[m][0]=a(n[m][0]),c[m][1]=a(n[m][1]),c[m][2]=n[m][2]):(c[m][0]=[].concat(a(c[m][0]),a(n[m][0])),c[m][1]=[].concat(a(c[m][1]),a(n[m][1])),c[m][2]=n[m][2]);console.log(s(c,"111111111111111111111111111111111111111111111111111111111111111111"," at pages\\msg\\msg.vue:300"));var g=[];for(var o in c)g.push({uid:c[o][2],time:c[o][0],msg:c[o][1]}),console.log(s(o," at pages\\msg\\msg.vue:305"));console.log(s(g,"显示在聊天列表里面的数据"," at pages\\msg\\msg.vue:307")),e.setStorage({key:"summsg",data:c,success:function(e){console.log(s("数据插入成功"," at pages\\msg\\msg.vue:312"))}}),console.log(s(c,"###################这是state.summsg############################"," at pages\\msg\\msg.vue:315")),console.log(s("聊天函数被触发"," at pages\\msg\\msg.vue:316")),t.changedata()}}})},1e3)},toChat:function(t){e.navigateTo({url:"chat/chat?uid="+t.uid+"&name="+t.username+"&youface="+t.face})}}};t.default=c}).call(this,s("6e42")["default"],s("0de9")["default"])}},[["6cf9","common/runtime","common/vendor"]]]);