(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/msg/msg"],{"367d":function(e,t,s){"use strict";s.r(t);var a=s("baf3"),n=s.n(a);for(var o in a)"default"!==o&&function(e){s.d(t,e,function(){return a[e]})}(o);t["default"]=n.a},"6cf9":function(e,t,s){"use strict";(function(e){s("590e"),s("921b");a(s("66fd"));var t=a(s("9c08"));function a(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,s("6e42")["createPage"])},"7b35":function(e,t,s){"use strict";var a=s("a9d2"),n=s.n(a);n.a},"9c08":function(e,t,s){"use strict";s.r(t);var a=s("b327"),n=s("367d");for(var o in n)"default"!==o&&function(e){s.d(t,e,function(){return n[e]})}(o);s("7b35");var u=s("2877"),i=Object(u["a"])(n["default"],a["a"],a["b"],!1,null,null,null);t["default"]=i.exports},a9d2:function(e,t,s){},b327:function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement;e._self._c},n=[];s.d(t,"a",function(){return a}),s.d(t,"b",function(){return n})},baf3:function(e,t,s){"use strict";(function(e,s){function a(e){return u(e)||o(e)||n()}function n(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function o(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function u(e){if(Array.isArray(e)){for(var t=0,s=new Array(e.length);t<e.length;t++)s[t]=e[t];return s}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={data:function(){return{SUMMSG:{},chatList:[{uid:1,username:"蓝沢助手",face:"/static/img/im/face/face_1.jpg",time:"13:08",msg:"亲，我们的工作时间是8点到20点",tisNum:1}]}},onPullDownRefresh:function(){setTimeout(function(){e.stopPullDownRefresh()},1e3)},onLoad:function(){this.changedata(),this.getmymsg()},methods:{endgetlist:function(t){var a=[];console.log(s(t," at pages\\msg\\msg.vue:54"));var n=0;for(var o in t)a[n]={},a[n]["uid"]=t[o][2],a[n]["time"]=t[o][0][t[o][0].length-1],a[n]["msg"]=t[o][1][t[o][0].length-1]["msg"],a[n]["tisNum"]=1,a[n]["pace"]="https://simplett-img.oss-cn-beijing.aliyuncs.com/user_image/userimage.jpg",a[n]["username"]="simplett",n++;this.chatList=a,console.log(s(a,"提取出聊天的列表"," at pages\\msg\\msg.vue:68"));var u=function(t){g=a[t].uid,e.request({url:"http://120.79.19.253:10086/Search",data:{uid:g,type:"user"},success:function(e){console.log(s(e.data," at pages\\msg\\msg.vue:79")),a[t]["username"]=e.data.nickname,a[t]["face"]=e.data.image}})};for(var i in a){var g;u(i)}this.chatList={},this.chatList=a,console.log(s(this.chatList,"??????"," at pages\\msg\\msg.vue:87"))},changedata:function(){var t=this;e.getStorage({key:"summsg",success:function(e){t.SUMMSG=e.data,console.log(s(e.data," at pages\\msg\\msg.vue:94")),e.data&&t.endgetlist(e.data)},fail:function(e){console.log(s("失败"," at pages\\msg\\msg.vue:102"))}})},getmymsg:function(){var t=this;setInterval(function(){console.log(s("请求聊天的数据"," at pages\\msg\\msg.vue:108"));var n="";e.getStorage({key:"token",success:function(e){n=e.data}}),n&&e.request({url:"http://120.79.19.253:10086/Chat",data:{token:n,type:"get"},success:function(n){console.log(s(n.data," at pages\\msg\\msg.vue:124"));var o=n.data.data,u={};if(o){console.log(s("收到的聊天消息",o," at pages\\msg\\msg.vue:128")),u=o.reduce(function(e,t){console.log(s(JSON.parse(t.message)," at pages\\msg\\msg.vue:131"));var a=JSON.parse(t.message);return void 0===e[a.suid]?(e[a.suid]=[[]],e[a.suid][0]=[],e[a.suid][1]=[],e[a.suid][2]="",e[a.suid][0].unshift(a.time),e[a.suid][1].unshift({user:"you",msg:a.message}),e[a.suid][2]=a.suid):(e[a.suid][0].unshift(a.time),e[a.suid][1].unshift({user:"you",msg:a.message})),e},{});var i={};for(var g in e.getStorage({key:"summsg",success:function(e){i=e.data}}),u)void 0==i[g]?(i[g]=[[]],console.log(s("@@@@@@@@@@@@@@@@@@@@@@@@@",u[g][0],u[g][1],u[g][2],g," at pages\\msg\\msg.vue:173")),i[g][0]=[],console.log(s("&&&&&&&&&&&&&&&&&&&&&",u[g][0]," at pages\\msg\\msg.vue:175")),i[g][1]=[],i[g][2]="",i[g][0]=a(u[g][0]),i[g][1]=a(u[g][1]),i[g][2]=u[g][2]):(i[g][0]=[].concat(a(i[g][0]),a(u[g][0])),i[g][1]=[].concat(a(i[g][1]),a(u[g][1])),i[g][2]=u[g][2]);console.log(s(i,"111111111111111111111111111111111111111111111111111111111111111111"," at pages\\msg\\msg.vue:187"));var c=[];for(var r in i)c.push({uid:i[r][2],time:i[r][0],msg:i[r][1]}),console.log(s(r," at pages\\msg\\msg.vue:192"));console.log(s(c,"显示在聊天列表里面的数据"," at pages\\msg\\msg.vue:194")),e.setStorage({key:"summsg",data:i,success:function(e){console.log(s("数据插入成功"," at pages\\msg\\msg.vue:199"))}}),console.log(s(i,"###################这是state.summsg############################"," at pages\\msg\\msg.vue:202")),console.log(s("聊天函数被触发"," at pages\\msg\\msg.vue:203")),t.changedata()}}})},1e3)},toChat:function(t){e.navigateTo({url:"chat/chat?uid="+t.uid+"&name="+t.username+"&youface="+t.face})}}};t.default=i}).call(this,s("6e42")["default"],s("0de9")["default"])}},[["6cf9","common/runtime","common/vendor"]]]);